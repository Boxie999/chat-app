{"ast":null,"code":"import _objectSpread from\"/Users/admin/Downloads/chat-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/admin/Downloads/chat-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef,useState}from\"react\";import{query,collection,orderBy,onSnapshot,limit}from\"firebase/firestore\";import{db}from\"../firebase\";import Message from\"./Message\";import SendMessage from\"./SendMessage\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ChatBox=function ChatBox(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),messages=_useState2[0],setMessages=_useState2[1];var scroll=useRef();useEffect(function(){var q=query(collection(db,\"messages\"),orderBy(\"createdAt\"),limit(50));var unsubscribe=onSnapshot(q,function(QuerySnapshot){var messages=[];QuerySnapshot.forEach(function(doc){messages.push(_objectSpread(_objectSpread({},doc.data()),{},{id:doc.id}));});setMessages(messages);});return function(){return unsubscribe;};},[]);return/*#__PURE__*/_jsxs(\"main\",{className:\"chat-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"messages-wrapper\",children:messages===null||messages===void 0?void 0:messages.map(function(message){return/*#__PURE__*/_jsx(Message,{message:message},message.id);})}),/*#__PURE__*/_jsx(\"span\",{ref:scroll}),/*#__PURE__*/_jsx(SendMessage,{scroll:scroll})]});};export default ChatBox;","map":{"version":3,"names":["React","useEffect","useRef","useState","query","collection","orderBy","onSnapshot","limit","db","Message","SendMessage","jsx","_jsx","jsxs","_jsxs","ChatBox","_useState","_useState2","_slicedToArray","messages","setMessages","scroll","q","unsubscribe","QuerySnapshot","forEach","doc","push","_objectSpread","data","id","className","children","map","message","ref"],"sources":["/Users/admin/Downloads/chat-app/src/components/ChatBox.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport {\n  query,\n  collection,\n  orderBy,\n  onSnapshot,\n  limit,\n} from \"firebase/firestore\";\nimport { db } from \"../firebase\";\nimport Message from \"./Message\";\nimport SendMessage from \"./SendMessage\";\n\nconst ChatBox = () => {\n  const [messages, setMessages] = useState([]);\n  const scroll = useRef();\n\n  useEffect(() => {\n    const q = query(\n      collection(db, \"messages\"),\n      orderBy(\"createdAt\"),\n      limit(50)\n    );\n\n    const unsubscribe = onSnapshot(q, (QuerySnapshot) => {\n      let messages = [];\n      QuerySnapshot.forEach((doc) => {\n        messages.push({ ...doc.data(), id: doc.id });\n      });\n      setMessages(messages);\n    });\n    return () => unsubscribe;\n  }, []);\n\n  return (\n    <main className=\"chat-box\">\n      <div className=\"messages-wrapper\">\n        {messages?.map((message) => (\n          <Message key={message.id} message={message} />\n        ))}\n      </div>\n      {/* when a new message enters the chat, the screen scrolls dowwn to the scroll div */}\n      <span ref={scroll}></span>\n      <SendMessage scroll={scroll} />\n    </main>\n  );\n};\n\nexport default ChatBox;"],"mappings":"yOAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,MAAM,CAAEC,QAAQ,KAAQ,OAAO,CAC1D,OACEC,KAAK,CACLC,UAAU,CACVC,OAAO,CACPC,UAAU,CACVC,KAAK,KACA,oBAAoB,CAC3B,OAASC,EAAE,KAAQ,aAAa,CAChC,MAAO,CAAAC,OAAO,KAAM,WAAW,CAC/B,MAAO,CAAAC,WAAW,KAAM,eAAe,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAExC,GAAM,CAAAC,OAAO,CAAG,QAAV,CAAAA,OAAOA,CAAA,CAAS,CACpB,IAAAC,SAAA,CAAgCd,QAAQ,CAAC,EAAE,CAAC,CAAAe,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAArCG,QAAQ,CAAAF,UAAA,IAAEG,WAAW,CAAAH,UAAA,IAC5B,GAAM,CAAAI,MAAM,CAAGpB,MAAM,CAAC,CAAC,CAEvBD,SAAS,CAAC,UAAM,CACd,GAAM,CAAAsB,CAAC,CAAGnB,KAAK,CACbC,UAAU,CAACI,EAAE,CAAE,UAAU,CAAC,CAC1BH,OAAO,CAAC,WAAW,CAAC,CACpBE,KAAK,CAAC,EAAE,CACV,CAAC,CAED,GAAM,CAAAgB,WAAW,CAAGjB,UAAU,CAACgB,CAAC,CAAE,SAACE,aAAa,CAAK,CACnD,GAAI,CAAAL,QAAQ,CAAG,EAAE,CACjBK,aAAa,CAACC,OAAO,CAAC,SAACC,GAAG,CAAK,CAC7BP,QAAQ,CAACQ,IAAI,CAAAC,aAAA,CAAAA,aAAA,IAAMF,GAAG,CAACG,IAAI,CAAC,CAAC,MAAEC,EAAE,CAAEJ,GAAG,CAACI,EAAE,EAAE,CAAC,CAC9C,CAAC,CAAC,CACFV,WAAW,CAACD,QAAQ,CAAC,CACvB,CAAC,CAAC,CACF,MAAO,kBAAM,CAAAI,WAAW,GAC1B,CAAC,CAAE,EAAE,CAAC,CAEN,mBACET,KAAA,SAAMiB,SAAS,CAAC,UAAU,CAAAC,QAAA,eACxBpB,IAAA,QAAKmB,SAAS,CAAC,kBAAkB,CAAAC,QAAA,CAC9Bb,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAEc,GAAG,CAAC,SAACC,OAAO,qBACrBtB,IAAA,CAACH,OAAO,EAAkByB,OAAO,CAAEA,OAAQ,EAA7BA,OAAO,CAACJ,EAAuB,CAAC,EAC/C,CAAC,CACC,CAAC,cAENlB,IAAA,SAAMuB,GAAG,CAAEd,MAAO,CAAO,CAAC,cAC1BT,IAAA,CAACF,WAAW,EAACW,MAAM,CAAEA,MAAO,CAAE,CAAC,EAC3B,CAAC,CAEX,CAAC,CAED,cAAe,CAAAN,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}